---
title: 编译原理
date: 2021-03-02 13:44:28
categories: 
- 编译原理
tags: [编译原理]
keywords: [编译原理]
---

## 编译成为可执行文件的过程

.c --> (编译) --> .s -->(汇编) .o --> (链接) .out  

### 预处理

主要是对#include #define #if等宏定义进行展开替换。

### 编译

词法分析、语法分析、语义分析，部分还会有中间代码的生成，最后生成目标代码。

#### 词法分析
这个阶段的任务是从左到右一个字符一个字符地读入源程序，即对构成源程序的字符流进行扫描然后根据构词规则识别单词(也称单词符号或符号)。

#### 语法分析
语法分析是编译过程的一个逻辑阶段。

语法分析的任务是在词法分析的基础上将单词序列组合成各类语法短语，如“程序”，“语句”，“表达式”等等。语法分析程序判断源程序在结构上是否正确。源程序的结构由上下文无关文法描述。


#### 语义分析
语义分析的任务是对结构上正确的源程序进行上下文有关性质的审查, 进行类型审查。即：诸如符号的使用是否得当，表达式的类型是否兼容等。

### 汇编
将汇编代码生成目标机器码。

### 链接

随着项目文件的变多，不可能在一个文件中进行编码。所以我们会同时分开多个文件进行编程，在编译后，需要将多个文件的目标文件(.o)进行链接，保证他们之间各个模块的关系正确。

链接器的主要作用是把各个模块之间的相互引用的部分处理好，使得各个模块之间能够正确的衔接。

具体要做的主要有：
1. 地址的重定位：静态链接和动态链接用到的函数的地址就是这个阶段填入；同时一些重复的指令地址也要重新编排。
2. 符号的统一：a和b都有同一个变量，在链接的时候就会发现它们这个变量命名是重复的，这时候就要做符号上的统一。

分成静态链接和动态链接：

1. 静态链接：静态链接指的是.o文件与链接库.a文件拼接在一起，组成可执行文件。这样编译出的可执行文件较大，也占用较大的内存空间，如果可执行程序，被并发运行多次，则会重复调用.a链接库文件进入内存。这样就造成了很大的浪费。静态链接是以空间换取时间。

2. 动态链接：动态链接是指，链接库文件不是和.o文件拼接在一起，而是当执行文件运行时，才动态的去内存调用库文件，如果没有就动态的加载。动态链接是以时间换取空间。

